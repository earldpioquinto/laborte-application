import{r as x,j as s,B as D,G as $,g as I}from"./index-mqNgpQq7.js";import{u as P,F as A,I as B,S as O,d as U,D as T,M as k}from"./dataStore-BeDGY16T.js";import{G as z}from"./GridToolbar-B3HiYU8t.js";import"./SubCard-B2I1m8Lm.js";const h=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],y=new Date().getFullYear(),H=Array.from({length:y-2009},(i,c)=>y-c+1),R=()=>{const[i,c]=x.useState(y),Y=e=>{c(e.target.value)},N=P(e=>e.memberData),g=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),b=[{field:"fullName",headerName:"Name",flex:1,minWidth:200},{field:"previousYearTotal",headerName:"Last Period",flex:1,minWidth:100},...h.map((e,a)=>[{field:`${e}_value`,headerName:`${e.toUpperCase()}`,minWidth:125,flex:1,headerClassName:a%2===0?"evenColumn":"oddColumn",cellClassName:a%2===0?"evenColumn":"oddColumn",textAlign:"right",valueGetter:r=>{const l=r;return l!==void 0&&l>0?g(l):"-"}},{field:`${e}_percentage`,headerName:"%",minWidth:100,flex:1,headerClassName:a%2===0?"evenColumn":"oddColumn",cellClassName:a%2===0?"evenColumn":"oddColumn",valueGetter:r=>{const l=r;return l>0?`${l}%`:"-"}}]).flat(),{field:"averagePercent",headerName:"AVE %",flex:1,minWidth:100,headerClassName:"evenColumn",cellClassName:"evenColumn",valueGetter:e=>{const a=e;return a!==void 0?`${a}%`:"0%"}}],W=()=>{const e={};return N.forEach(a=>{h.forEach(r=>{var f,v,t,u;const l=((v=(f=a.records)==null?void 0:f.savings)==null?void 0:v.filter(o=>o.year===i&&new Date(o.year,o.month-1).toLocaleString("default",{month:"short"}).toLowerCase()===r))||[],C=((u=(t=a.records)==null?void 0:t.shares)==null?void 0:u.filter(o=>o.year===i&&new Date(o.year,o.month-1).toLocaleString("default",{month:"short"}).toLowerCase()===r))||[],p=l.reduce((o,d)=>o+parseFloat(d.value),0)+C.reduce((o,d)=>o+parseFloat(d.value),0);e[r]||(e[r]=0),e[r]+=p})}),e},m=x.useMemo(()=>W(),[i,N]),_=N.map(e=>{var C,p,f,v;const a={id:e.id,fullName:`${e.first_name} ${e.last_name}`},r=(((p=(C=e.records)==null?void 0:C.savings)==null?void 0:p.filter(t=>t.year===i-1&&t.month===12).reduce((t,u)=>t+parseFloat(u.value),0))||0)+(((v=(f=e.records)==null?void 0:f.shares)==null?void 0:v.filter(t=>t.year===i-1&&t.month===12).reduce((t,u)=>t+parseFloat(u.value),0))||0);a.previousYearTotal=r>0?g(r):"-";let l=0;return h.forEach(t=>{var F,S,L,G;const u=((S=(F=e.records)==null?void 0:F.savings)==null?void 0:S.filter(n=>n.year===i&&new Date(n.year,n.month-1).toLocaleString("default",{month:"short"}).toLowerCase()===t))||[],o=((G=(L=e.records)==null?void 0:L.shares)==null?void 0:G.filter(n=>n.year===i&&new Date(n.year,n.month-1).toLocaleString("default",{month:"short"}).toLowerCase()===t))||[],d=u.reduce((n,w)=>n+parseFloat(w.value),0)+o.reduce((n,w)=>n+parseFloat(w.value),0);a[`${t}_value`]=d!==0?d:"-";const j=m[t]!==0?(d/m[t]*100).toFixed(2):0;a[`${t}_percentage`]=j!==0?j:"-",l+=parseFloat(j)}),a.averagePercent=(l/12).toFixed(2),a}),E=[{field:"fullName",headerName:"",flex:1,minWidth:200},...h.map((e,a)=>({field:`${e}_total`,headerName:`${e.toUpperCase()}`,minWidth:100,flex:1,headerClassName:a%2===0?"evenColumn":"oddColumn",cellClassName:a%2===0?"evenColumn":"oddColumn",valueGetter:r=>{const l=r;return l!==void 0&&l>0?g(l):"-"}})),{field:"total",headerName:"TOTAL",flex:1,minWidth:100,headerClassName:"evenColumn",cellClassName:"evenColumn",valueGetter:e=>{const a=e;return a!==void 0?g(a):"0"}}],M={id:"total",fullName:"Monthly Totals",...h.reduce((e,a)=>{const r=m[a]!==void 0?m[a]:0;return{...e,[`${a}_total`]:r}},{}),total:Object.values(m).reduce((e,a)=>e+a,0)};return s.jsxs(D,{sx:{width:"100%"},children:[s.jsx(D,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:s.jsxs(A,{sx:{minWidth:120},children:[s.jsx(B,{id:"year-label",children:"Year"}),s.jsx(O,{labelId:"year-label",value:i,label:"Year",onChange:Y,children:H.map(e=>s.jsx(U,{value:e,children:e},e))})]})}),s.jsx(T,{rows:_,columns:b,components:{Toolbar:z},pagination:!0,pageSizeOptions:[5,20,100],pageSize:5,autoHeight:!0,sx:{"& .evenColumn":{backgroundColor:"#ff00ff11"},"& .MuiDataGrid-virtualScroller":{overflow:"auto"}}}),s.jsx(D,{sx:{height:200,width:"100%",marginTop:2},children:s.jsx(T,{rows:[M],columns:E,hideFooter:!0,autoHeight:!0,sx:{"& .evenColumn":{backgroundColor:"#ff00ff11"},"& .MuiDataGrid-virtualScroller":{overflow:"auto"}}})})]})},Q=()=>{const[i,c]=x.useState(!0);return x.useEffect(()=>{c(!1)},[]),s.jsx(k,{title:"Dividends",children:s.jsx($,{container:!0,spacing:I,children:s.jsx($,{item:!0,xs:12,children:s.jsx(R,{})})})})};export{Q as default};
