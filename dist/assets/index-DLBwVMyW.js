import{r as C,j as a,B as c,G as p,g as T}from"./index-CClNU_iK.js";import{u as b,F as D,I as R,S as Y,d as A,D as x,M as E}from"./dataStore-Dp7uGn6q.js";import{G as I}from"./GridToolbar-BGl_Ocuo.js";const f=[{field:"fullName",headerName:"Name",minWidth:200,editable:!0},{field:"jan",headerName:"JAN",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"feb",headerName:"FEB",width:100,editable:!0},{field:"mar",headerName:"MAR",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"apr",headerName:"APR",width:100,editable:!0},{field:"may",headerName:"MAY",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"jun",headerName:"JUN",width:100,editable:!0},{field:"jul",headerName:"JUL",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"aug",headerName:"AUG",width:100,editable:!0},{field:"sep",headerName:"SEP",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"oct",headerName:"OCT",width:100,editable:!0},{field:"nov",headerName:"NOV",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"dec",headerName:"DEC",width:100,editable:!0},{field:"total",headerName:"TOTAL",width:100,editable:!0}],N=new Date().getFullYear(),M=Array.from({length:N-2009},(o,s)=>N-s+1);function G(){const[o,s]=C.useState(N),w=b(e=>e.memberData),j=b(e=>e.updateInterestRow),v=e=>{s(e.target.value)},y=(e,t)=>(j(e),e),u=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),h=w.map(e=>{var m;const d=(((m=e.records)==null?void 0:m.loans)||[]).filter(l=>l.year===o),i={id:e.id,fullName:`${e.first_name} ${e.last_name}`},r={jan:0,feb:0,mar:0,apr:0,may:0,jun:0,jul:0,aug:0,sep:0,oct:0,nov:0,dec:0,total:0};return d.forEach(l=>{const L=new Date(l.year,l.month-1).toLocaleString("default",{month:"short"}).toLowerCase();r[L]+=parseFloat(l.value),r.total+=parseFloat(l.value)}),Object.keys(r).forEach(l=>{i[l]=r[l]===0?"-":u(r[l])}),i});console.log("Aggregated Loans:",h);const n=f.reduce((e,t)=>{if(t.field!=="fullName"&&t.field!=="total"){const d=h.reduce((i,r)=>{const m=parseFloat(r[t.field]!=="-"?r[t.field].replace(/,/g,""):0);return i+m},0);e[t.field]=d===0?"-":u(d)}return e},{});console.log("Monthly Totals:",n);const g=Object.values(n).reduce((e,t)=>e+(t!=="-"?parseFloat(t.replace(/,/g,"")):0),0);n.total=g===0?"-":u(g);const F={id:"total",fullName:"Monthly Totals",...n},S=f.map(e=>({...e,headerName:e.field==="fullName"?"":e.headerName}));return a.jsxs(c,{sx:{width:"100%"},children:[a.jsx(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:a.jsxs(D,{sx:{minWidth:120},children:[a.jsx(R,{id:"year-label",children:"Year"}),a.jsx(Y,{labelId:"year-label",value:o,label:"Year",onChange:v,children:M.map(e=>a.jsx(A,{value:e,children:e},e))})]})}),a.jsx(x,{rows:h,columns:f,components:{Toolbar:I},pagination:!0,pageSizeOptions:[5,20,100],pageSize:5,autoHeight:!0,processRowUpdate:y,sx:{"& .evenColumn":{backgroundColor:"#ff00ff11"}}}),a.jsx(c,{sx:{height:200,width:"100%",marginTop:2},children:a.jsx(x,{rows:[F],columns:S,hideFooter:!0,autoHeight:!0,sx:{"& .evenColumn":{backgroundColor:"#ff00ff11"}}})})]})}const J=()=>{const[o,s]=C.useState(!0);return C.useEffect(()=>{s(!1)},[]),a.jsx(E,{title:"Loans",children:a.jsx(p,{container:!0,spacing:T,children:a.jsx(p,{item:!0,xs:12,children:a.jsx(G,{})})})})};export{J as default};
