import{a as $,b as F,r as u,s as R,c as _e,M as Ue,d as V,_ as f,e as be,u as I,f as Be,h as A,i as Le,j as t,k as P,l as W,F as Ye,T as Re,m as He,n as ve,o as U,G as g,g as q,B as _,p as Ne}from"./index-Do10mwPs.js";import{S as Y}from"./SubCard-D7kuVxSN.js";import{a as Ee,b as ge,u as w,M as Q,T as C,B as j,c as N,d as E,F as Je,I as ze,S as Ve,D as fe}from"./dataStore-C6ZPsL-o.js";import{D as K}from"./DynamicModal-OV_YS6ET.js";function Ge(e){return F("MuiDialog",e)}const he=$("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),Pe=u.createContext({}),Xe=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],Ke=R(_e,{name:"MuiDialog",slot:"Backdrop",overrides:(e,a)=>a.backdrop})({zIndex:-1}),qe=e=>{const{classes:a,scroll:r,maxWidth:n,fullWidth:c,fullScreen:l}=e,m={root:["root"],container:["container",`scroll${V(r)}`],paper:["paper",`paperScroll${V(r)}`,`paperWidth${V(String(n))}`,c&&"paperFullWidth",l&&"paperFullScreen"]};return W(m,Ge,a)},Qe=R(Ue,{name:"MuiDialog",slot:"Root",overridesResolver:(e,a)=>a.root})({"@media print":{position:"absolute !important"}}),Ze=R("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.container,a[`scroll${V(r.scroll)}`]]}})(({ownerState:e})=>f({height:"100%","@media print":{height:"auto"},outline:0},e.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},e.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),et=R(be,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.paper,a[`scrollPaper${V(r.scroll)}`],a[`paperWidth${V(String(r.maxWidth))}`],r.fullWidth&&a.paperFullWidth,r.fullScreen&&a.paperFullScreen]}})(({theme:e,ownerState:a})=>f({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},a.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},a.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!a.maxWidth&&{maxWidth:"calc(100% - 64px)"},a.maxWidth==="xs"&&{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${he.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},a.maxWidth&&a.maxWidth!=="xs"&&{maxWidth:`${e.breakpoints.values[a.maxWidth]}${e.breakpoints.unit}`,[`&.${he.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[a.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},a.fullWidth&&{width:"calc(100% - 64px)"},a.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${he.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),re=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiDialog"}),c=Be(),l={enter:c.transitions.duration.enteringScreen,exit:c.transitions.duration.leavingScreen},{"aria-describedby":m,"aria-labelledby":i,BackdropComponent:h,BackdropProps:o,children:p,className:x,disableEscapeKeyDown:d=!1,fullScreen:v=!1,fullWidth:D=!1,maxWidth:s="sm",onBackdropClick:y,onClick:O,onClose:M,open:Z,PaperComponent:J=be,PaperProps:ee={},scroll:de="paper",TransitionComponent:ue=Ye,transitionDuration:b=l,TransitionProps:T}=n,B=A(n,Xe),S=f({},n,{disableEscapeKeyDown:d,fullScreen:v,fullWidth:D,maxWidth:s,scroll:de}),G=qe(S),z=u.useRef(),te=L=>{z.current=L.target===L.currentTarget},X=L=>{O&&O(L),z.current&&(z.current=null,y&&y(L),M&&M(L,"backdropClick"))},H=Le(i),k=u.useMemo(()=>({titleId:H}),[H]);return t.jsx(Qe,f({className:P(G.root,x),closeAfterTransition:!0,components:{Backdrop:Ke},componentsProps:{backdrop:f({transitionDuration:b,as:h},o)},disableEscapeKeyDown:d,onClose:M,open:Z,ref:r,onClick:X,ownerState:S},B,{children:t.jsx(ue,f({appear:!0,in:Z,timeout:b,role:"presentation"},T,{children:t.jsx(Ze,{className:P(G.container),onMouseDown:te,ownerState:S,children:t.jsx(et,f({as:J,elevation:24,role:"dialog","aria-describedby":m,"aria-labelledby":H},ee,{className:P(G.paper,ee.className),ownerState:S,children:t.jsx(Pe.Provider,{value:k,children:p})}))})}))}))});function tt(e){return F("MuiDialogActions",e)}$("MuiDialogActions",["root","spacing"]);const at=["className","disableSpacing"],ot=e=>{const{classes:a,disableSpacing:r}=e;return W({root:["root",!r&&"spacing"]},tt,a)},nt=R("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.root,!r.disableSpacing&&a.spacing]}})(({ownerState:e})=>f({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),se=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiDialogActions"}),{className:c,disableSpacing:l=!1}=n,m=A(n,at),i=f({},n,{disableSpacing:l}),h=ot(i);return t.jsx(nt,f({className:P(h.root,c),ownerState:i,ref:r},m))});function rt(e){return F("MuiDialogContent",e)}$("MuiDialogContent",["root","dividers"]);function st(e){return F("MuiDialogTitle",e)}const lt=$("MuiDialogTitle",["root"]),it=["className","dividers"],ct=e=>{const{classes:a,dividers:r}=e;return W({root:["root",r&&"dividers"]},rt,a)},dt=R("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.root,r.dividers&&a.dividers]}})(({theme:e,ownerState:a})=>f({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},a.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${lt.root} + &`]:{paddingTop:0}})),le=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiDialogContent"}),{className:c,dividers:l=!1}=n,m=A(n,it),i=f({},n,{dividers:l}),h=ct(i);return t.jsx(dt,f({className:P(h.root,c),ownerState:i,ref:r},m))});function ut(e){return F("MuiDialogContentText",e)}$("MuiDialogContentText",["root"]);const mt=["children","className"],pt=e=>{const{classes:a}=e,n=W({root:["root"]},ut,a);return f({},a,n)},ht=R(Re,{shouldForwardProp:e=>He(e)||e==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,a)=>a.root})({}),ie=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiDialogContentText"}),{className:c}=n,l=A(n,mt),m=pt(l);return t.jsx(ht,f({component:"p",variant:"body1",color:"text.secondary",ref:r,ownerState:l,className:P(m.root,c)},n,{classes:m}))}),xt=["className","id"],bt=e=>{const{classes:a}=e;return W({root:["root"]},st,a)},gt=R(Re,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,a)=>a.root})({padding:"16px 24px",flex:"0 0 auto"}),ce=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiDialogTitle"}),{className:c,id:l}=n,m=A(n,xt),i=n,h=bt(i),{titleId:o=l}=u.useContext(Pe);return t.jsx(gt,f({component:"h2",className:P(h.root,c),ownerState:i,ref:r,variant:"h6",id:l??o},m))});function ft(e){return F("MuiTable",e)}$("MuiTable",["root","stickyHeader"]);const vt=["className","component","padding","size","stickyHeader"],yt=e=>{const{classes:a,stickyHeader:r}=e;return W({root:["root",r&&"stickyHeader"]},ft,a)},Ct=R("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.root,r.stickyHeader&&a.stickyHeader]}})(({theme:e,ownerState:a})=>f({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":f({},e.typography.body2,{padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"})},a.stickyHeader&&{borderCollapse:"separate"})),ye="table",jt=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiTable"}),{className:c,component:l=ye,padding:m="normal",size:i="medium",stickyHeader:h=!1}=n,o=A(n,vt),p=f({},n,{component:l,padding:m,size:i,stickyHeader:h}),x=yt(p),d=u.useMemo(()=>({padding:m,size:i,stickyHeader:h}),[m,i,h]);return t.jsx(Ee.Provider,{value:d,children:t.jsx(Ct,f({as:l,role:l===ye?null:"table",ref:r,className:P(x.root,c),ownerState:p},o))})});function wt(e){return F("MuiTableBody",e)}$("MuiTableBody",["root"]);const Dt=["className","component"],Mt=e=>{const{classes:a}=e;return W({root:["root"]},wt,a)},St=R("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(e,a)=>a.root})({display:"table-row-group"}),Rt={variant:"body"},Ce="tbody",Nt=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiTableBody"}),{className:c,component:l=Ce}=n,m=A(n,Dt),i=f({},n,{component:l}),h=Mt(i);return t.jsx(ge.Provider,{value:Rt,children:t.jsx(St,f({className:P(h.root,c),as:l,ref:r,role:l===Ce?null:"rowgroup",ownerState:i},m))})});function Pt(e){return F("MuiTableContainer",e)}$("MuiTableContainer",["root"]);const Tt=["className","component"],kt=e=>{const{classes:a}=e;return W({root:["root"]},Pt,a)},$t=R("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,a)=>a.root})({width:"100%",overflowX:"auto"}),Ft=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiTableContainer"}),{className:c,component:l="div"}=n,m=A(n,Tt),i=f({},n,{component:l}),h=kt(i);return t.jsx($t,f({ref:r,as:l,className:P(h.root,c),ownerState:i},m))});function It(e){return F("MuiTableHead",e)}$("MuiTableHead",["root"]);const At=["className","component"],Wt=e=>{const{classes:a}=e;return W({root:["root"]},It,a)},Ot=R("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(e,a)=>a.root})({display:"table-header-group"}),_t={variant:"head"},je="thead",Ut=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiTableHead"}),{className:c,component:l=je}=n,m=A(n,At),i=f({},n,{component:l}),h=Wt(i);return t.jsx(ge.Provider,{value:_t,children:t.jsx(Ot,f({as:l,className:P(h.root,c),ref:r,role:l===je?null:"rowgroup",ownerState:i},m))})});function Bt(e){return F("MuiTableRow",e)}const we=$("MuiTableRow",["root","selected","hover","head","footer"]),Lt=["className","component","hover","selected"],Yt=e=>{const{classes:a,selected:r,hover:n,head:c,footer:l}=e;return W({root:["root",r&&"selected",n&&"hover",c&&"head",l&&"footer"]},Bt,a)},Ht=R("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:r}=e;return[a.root,r.head&&a.head,r.footer&&a.footer]}})(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${we.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${we.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:ve(e.palette.primary.main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:ve(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)}}})),De="tr",Me=u.forwardRef(function(a,r){const n=I({props:a,name:"MuiTableRow"}),{className:c,component:l=De,hover:m=!1,selected:i=!1}=n,h=A(n,Lt),o=u.useContext(ge),p=f({},n,{component:l,hover:m,selected:i,head:o&&o.variant==="head",footer:o&&o.variant==="footer"}),x=Yt(p);return t.jsx(Ht,f({as:l,ref:r,className:P(x.root,c),role:l===De?null:"row",ownerState:p},h))}),Et=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],oe=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),Jt=2,zt=({handleClose:e})=>{const{id:a}=U(),r=w(b=>b.updateMemberRecord),c=w(b=>b.memberData).find(b=>b.id===a),[l,m]=u.useState(""),[i,h]=u.useState(""),[o,p]=u.useState(new Date().toISOString().substring(0,10)),[x,d]=u.useState(Jt),[v,D]=u.useState(0),[s,y]=u.useState(0),[O,M]=u.useState([]),[Z,J]=u.useState(!1);u.useEffect(()=>{p(new Date().toISOString().substring(0,10))},[]);const ee=()=>{const b=parseFloat(l),T=parseInt(i,10),B=parseFloat(x)/100;if(!isNaN(b)&&!isNaN(T)&&!isNaN(B)){const S=b/T,G=Array.from({length:T}).reduce((ae,me,pe)=>{const Oe=b-S*pe;return ae+Oe*B},0),z=b+G,te=[];let X=b,[H,k,L]=o.split("-").map(Number);k++,k>12&&(k=1,H++);for(let ae=0;ae<T;ae++){k>12&&(k=1,H++);const me=X*B,pe=S+me;X-=S,te.push({monthLabel:Et[(k-1)%12].label,monthValue:k,year:H,day:L,payment:pe.toFixed(2),interestPayment:me.toFixed(2),principalPayment:S.toFixed(2),remainingPrincipal:X.toFixed(2)}),k++}y((z/T).toFixed(2)),D(z.toFixed(2)),M(te)}},de=()=>{var B;const b={month:parseInt(o.split("-")[1]),year:parseInt(o.split("-")[0]),day:parseInt(o.split("-")[2]),value:l,interest_rate:x,terms:i,totalPayment:v,monthlyPayment:s,paymentSchedule:O};((B=c.records.loans)==null?void 0:B.find(S=>S.month===b.month&&S.year===b.year&&S.day===b.day))?J(!0):(r(a,b,"loans"),e())},ue=()=>{const b={month:parseInt(o.split("-")[1]),year:parseInt(o.split("-")[0]),day:parseInt(o.split("-")[2]),value:l,interest_rate:x,terms:i,totalPayment:v,monthlyPayment:s,paymentSchedule:O};r(a,b,"loans"),J(!1),e()};return t.jsxs(Q,{title:"Add Loan",sx:{width:"1000px",margin:"auto"},children:[t.jsxs(g,{container:!0,spacing:q,sx:{maxHeight:"800px",overflow:"auto"},children:[t.jsx(g,{item:!0,xs:12,md:6,children:t.jsx(Y,{children:t.jsxs(g,{container:!0,spacing:2,children:[t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,label:"Amount",value:l,onChange:b=>m(b.target.value),type:"number",InputProps:{inputProps:{step:.01,min:0}}})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,label:"Term (Months)",value:i,onChange:b=>h(b.target.value),type:"number",InputProps:{inputProps:{min:1,max:24}}})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,label:"Loan Date",type:"date",value:o,onChange:b=>p(b.target.value),InputLabelProps:{shrink:!0}})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,label:"Interest Rate (%)",value:x,onChange:b=>d(b.target.value),type:"number",InputProps:{inputProps:{step:.01,min:0,max:99}}})}),t.jsxs(g,{item:!0,xs:12,container:!0,justifyContent:"space-between",children:[t.jsx(j,{variant:"contained",color:"primary",onClick:ee,children:"Calculate"}),t.jsx(j,{variant:"contained",color:"primary",onClick:de,children:"Save"}),t.jsx(j,{variant:"outlined",color:"secondary",onClick:e,children:"Cancel"})]})]})})}),t.jsx(g,{item:!0,xs:12,md:6,children:t.jsx(Ft,{component:be,sx:{maxHeight:"500px"},children:t.jsxs(jt,{children:[t.jsx(Ut,{children:t.jsxs(Me,{children:[t.jsx(N,{sx:{width:200},children:"Month"}),t.jsx(N,{sx:{width:200},children:"Year"}),t.jsx(N,{sx:{width:200},children:"Payment"}),t.jsx(N,{sx:{width:200},children:"Interest"}),t.jsx(N,{sx:{width:200},children:"Principal"}),t.jsx(N,{sx:{width:200},children:"Remaining Balance"})]})}),t.jsx(Nt,{children:O.map((b,T)=>t.jsxs(Me,{children:[t.jsx(N,{sx:{width:200},children:b.monthLabel}),t.jsx(N,{sx:{width:200},children:b.year}),t.jsx(N,{sx:{width:200},children:oe(b.payment)}),t.jsx(N,{sx:{width:200},children:oe(b.interestPayment)}),t.jsx(N,{sx:{width:200},children:oe(b.principalPayment)}),t.jsx(N,{sx:{width:200},children:oe(b.remainingPrincipal)})]},T))})]})})})]}),t.jsxs(re,{open:Z,onClose:()=>J(!1),children:[t.jsx(ce,{children:"Record Exists"}),t.jsx(le,{children:t.jsx(ie,{children:"A record for this loan date already exists. Do you want to overwrite it?"})}),t.jsxs(se,{children:[t.jsx(j,{onClick:()=>J(!1),color:"secondary",children:"Cancel"}),t.jsx(j,{onClick:ue,color:"primary",children:"Overwrite"})]})]})]})},Te=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],ke=()=>new Date().getFullYear(),Vt=()=>{const e=new Date().getMonth();return Te[e].value},Gt=Array.from({length:ke()-2009+2},(e,a)=>2010+a).sort((e,a)=>a-e),Xt=({handleClose:e})=>{const{id:a}=U(),r=w(s=>s.updateMemberRecord),c=w(s=>s.memberData).find(s=>s.id===a),[l,m]=u.useState(ke()),[i,h]=u.useState(Vt()),[o,p]=u.useState(""),[x,d]=u.useState(!1),v=()=>{const s={month:i,year:l,value:o},y="savings";c.records||(c.records={}),c.records[y]||(c.records[y]=[]),c.records[y].find(M=>M.month===i&&M.year===l)?d(!0):(r(a,s,y),e())},D=()=>{r(a,{month:i,year:l,value:o},"savings"),d(!1),e()};return t.jsxs(Q,{title:"Add Saving",sx:{maxWidth:"500px",margin:"auto"},children:[t.jsx(g,{container:!0,spacing:q,sx:{maxHeight:"800px",overflow:"auto"},children:t.jsx(g,{item:!0,xs:12,children:t.jsx(Y,{children:t.jsxs(g,{container:!0,spacing:2,children:[t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,select:!0,label:"Year",value:l,onChange:s=>m(s.target.value),children:Gt.map(s=>t.jsx(E,{value:s,children:s},s))})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,select:!0,label:"Month",value:i,onChange:s=>h(s.target.value),children:Te.map(s=>t.jsx(E,{value:s.value,children:s.label},s.value))})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,label:"Amount",value:o,onChange:s=>p(s.target.value),type:"number",InputProps:{inputProps:{step:.01,min:0}}})}),t.jsxs(g,{item:!0,xs:12,container:!0,justifyContent:"space-between",children:[t.jsx(j,{variant:"contained",color:"primary",onClick:v,children:"Save"}),t.jsx(j,{variant:"outlined",color:"secondary",onClick:e,children:"Cancel"})]})]})})})}),t.jsxs(re,{open:x,onClose:()=>d(!1),children:[t.jsx(ce,{children:"Record Exists"}),t.jsx(le,{children:t.jsx(ie,{children:"A record for this month and year already exists. Do you want to overwrite it?"})}),t.jsxs(se,{children:[t.jsx(j,{onClick:()=>d(!1),color:"secondary",children:"Cancel"}),t.jsx(j,{onClick:D,color:"primary",children:"Overwrite"})]})]})]})},$e=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],Fe=()=>new Date().getFullYear(),Kt=()=>{const e=new Date().getMonth();return $e[e].value},qt=Array.from({length:Fe()-2009+2},(e,a)=>2010+a).sort((e,a)=>a-e),Qt=({handleClose:e})=>{const{id:a}=U(),r=w(s=>s.updateMemberRecord),c=w(s=>s.memberData).find(s=>s.id===a),[l,m]=u.useState(Fe()),[i,h]=u.useState(Kt()),[o,p]=u.useState(""),[x,d]=u.useState(!1),v=()=>{const s={month:i,year:l,value:o},y="shares";c.records||(c.records={}),c.records[y]||(c.records[y]=[]),c.records[y].find(M=>M.month===i&&M.year===l)?d(!0):(r(a,s,y),e())},D=()=>{r(a,{month:i,year:l,value:o},"shares"),d(!1),e()};return t.jsxs(Q,{title:"Add Share",sx:{maxWidth:"500px",margin:"auto"},children:[t.jsx(g,{container:!0,spacing:q,sx:{maxHeight:"800px",overflow:"auto"},children:t.jsx(g,{item:!0,xs:12,children:t.jsx(Y,{children:t.jsxs(g,{container:!0,spacing:2,children:[t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,select:!0,label:"Year",value:l,onChange:s=>m(s.target.value),children:qt.map(s=>t.jsx(E,{value:s,children:s},s))})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,select:!0,label:"Month",value:i,onChange:s=>h(s.target.value),children:$e.map(s=>t.jsx(E,{value:s.value,children:s.label},s.value))})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,label:"Amount",value:o,onChange:s=>p(s.target.value),type:"number",InputProps:{inputProps:{step:.01,min:0}}})}),t.jsxs(g,{item:!0,xs:12,container:!0,justifyContent:"space-between",children:[t.jsx(j,{variant:"contained",color:"primary",onClick:v,children:"Save"}),t.jsx(j,{variant:"outlined",color:"secondary",onClick:e,children:"Cancel"})]})]})})})}),t.jsxs(re,{open:x,onClose:()=>d(!1),children:[t.jsx(ce,{children:"Record Exists"}),t.jsx(le,{children:t.jsx(ie,{children:"A record for this month and year already exists. Do you want to overwrite it?"})}),t.jsxs(se,{children:[t.jsx(j,{onClick:()=>d(!1),color:"secondary",children:"Cancel"}),t.jsx(j,{onClick:D,color:"primary",children:"Overwrite"})]})]})]})},Zt=[{field:"type",headerName:"TYPE",width:110,editable:!0},{field:"jan",headerName:"JAN",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"feb",headerName:"FEB",width:100,editable:!0},{field:"mar",headerName:"MAR",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"apr",headerName:"APR",width:100,editable:!0},{field:"may",headerName:"MAY",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"jun",headerName:"JUN",width:100,editable:!0},{field:"jul",headerName:"JUL",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"aug",headerName:"AUG",width:100,editable:!0},{field:"sep",headerName:"SEP",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"oct",headerName:"OCT",width:100,editable:!0},{field:"nov",headerName:"NOV",width:100,editable:!0,headerClassName:"evenColumn",cellClassName:"evenColumn"},{field:"dec",headerName:"DEC",width:100,editable:!0},{field:"total",headerName:"TOTAL",width:120,editable:!0}],xe=new Date().getFullYear(),ea=Array.from({length:xe-2009},(e,a)=>xe-a+1);function ta(){const{id:e}=U(),[a,r]=u.useState(xe),n=w(d=>d.memberData),c=w(d=>d.updateInterestRow),l=w(d=>d.initializeInterestRows),m=w(d=>d.interestRows),i=n.find(d=>d.id===e);u.useEffect(()=>{i&&l(e,a)},[l,a,i,e]);const h=d=>{r(d.target.value),i&&l(e,d.target.value)},o=(d,v)=>(c(d),d),p=d=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(d),x=m.map(d=>{const v={...d};return Object.keys(v).forEach(D=>{D!=="total"&&v[D]===0?v[D]="-":D!=="type"&&(v[D]=p(v[D]))}),v});return t.jsxs(_,{sx:{width:"100%"},children:[t.jsxs(_,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:[t.jsxs(Je,{sx:{minWidth:120},children:[t.jsx(ze,{id:"year-label",children:"Year"}),t.jsx(Ve,{labelId:"year-label",value:a,label:"Year",onChange:h,children:ea.map(d=>t.jsx(E,{value:d,children:d},d))})]}),t.jsxs(_,{sx:{display:"flex",gap:1},children:[t.jsx(K,{component:zt,componentProps:{props:"loan"},buttonLabel:"Add Loan"}),t.jsx(K,{component:Xt,componentProps:{props:"saving"},buttonLabel:"Add Saving"}),t.jsx(K,{component:Qt,componentProps:{props:"share"},buttonLabel:"Add Share"})]})]}),t.jsx(fe,{autoHeight:!0,rows:x,columns:Zt,processRowUpdate:o,disableColumnMenu:!0,sortingOrder:null,disableColumnFilter:!0,disableColumnSelector:!0,disableColumnResize:!0,hideFooter:!0,disableRowSelectionOnClick:!0,sx:{"& .evenColumn":{backgroundColor:"#ff00ff11"}}})]})}const Ie=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],Ae=()=>new Date().getFullYear(),aa=()=>{const e=new Date().getMonth();return Ie[e].value},oa=Array.from({length:Ae()-2009+2},(e,a)=>2010+a).sort((e,a)=>a-e),We=({handleClose:e})=>{const{id:a}=U(),r=w(s=>s.updateMemberRecord),c=w(s=>s.memberData).find(s=>s.id===a),[l,m]=u.useState(Ae()),[i,h]=u.useState(aa()),[o,p]=u.useState(""),[x,d]=u.useState(!1),v=()=>{const s={month:i,year:l,value:o},y="payments";c.records||(c.records={}),c.records[y]||(c.records[y]=[]),c.records[y].find(M=>M.month===i&&M.year===l)?d(!0):(r(a,s,y),e())},D=()=>{r(a,{month:i,year:l,value:o},"payments"),d(!1),e()};return t.jsxs(Q,{title:"Add Payment",sx:{maxWidth:"500px",margin:"auto"},children:[t.jsx(g,{container:!0,spacing:q,sx:{maxHeight:"800px",overflow:"auto"},children:t.jsx(g,{item:!0,xs:12,children:t.jsx(Y,{children:t.jsxs(g,{container:!0,spacing:2,children:[t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,select:!0,label:"Year",value:l,onChange:s=>m(s.target.value),children:oa.map(s=>t.jsx(E,{value:s,children:s},s))})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,select:!0,label:"Month",value:i,onChange:s=>h(s.target.value),children:Ie.map(s=>t.jsx(E,{value:s.value,children:s.label},s.value))})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(C,{fullWidth:!0,label:"Amount",value:o,onChange:s=>p(s.target.value),type:"number",InputProps:{inputProps:{step:.01,min:0}}})}),t.jsxs(g,{item:!0,xs:12,container:!0,justifyContent:"space-between",children:[t.jsx(j,{variant:"contained",color:"primary",onClick:v,children:"Save"}),t.jsx(j,{variant:"outlined",color:"secondary",onClick:e,children:"Cancel"})]})]})})})}),t.jsxs(re,{open:x,onClose:()=>d(!1),children:[t.jsx(ce,{children:"Record Exists"}),t.jsx(le,{children:t.jsx(ie,{children:"A record for this month and year already exists. Do you want to overwrite it?"})}),t.jsxs(se,{children:[t.jsx(j,{onClick:()=>d(!1),color:"secondary",children:"Cancel"}),t.jsx(j,{onClick:D,color:"primary",children:"Overwrite"})]})]})]})},Se=e=>typeof e=="number"&&!isNaN(e)?e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):e,na=[{field:"date",headerName:"Date",width:130},{field:"value",headerName:"Value",width:130,valueFormatter:e=>Se(e)},{field:"interest_rate",headerName:"Interest Rate",width:130,valueFormatter:e=>`${e}%`},{field:"terms",headerName:"Terms"},{field:"totalPayment",headerName:"Total Payment",width:130,valueFormatter:e=>Se(e)}],ra=()=>{var i,h;const{id:e}=U(),a=w(o=>o.memberData),r=w(o=>o.updateLoanData),n=a.find(o=>o.id===e),c=n?(h=(i=n.records)==null?void 0:i.loans)==null?void 0:h.map((o,p)=>({id:p+1,date:`${new Date(o.year,o.month-1).toLocaleString("default",{month:"long"})} ${o.day}, ${o.year}`,value:parseFloat(o.value),interest_rate:parseFloat(o.interest_rate),terms:o.terms,totalPayment:parseFloat(o.totalPayment)})):[],l=o=>(r(o),o),m=o=>{const p=new Date,x=p.getFullYear(),d=p.getMonth(),v=new Date(Date.parse(o.row.date.split(" ")[0]+" 1, 2023")).getMonth();return o.row.year<x||o.row.year===x&&v<d?"highlight":""};return t.jsxs(_,{sx:{height:"374px",width:"100%"},children:[t.jsx(fe,{rows:c,columns:na,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,processRowUpdate:l,initialState:{pagination:{paginationModel:{pageSize:5,page:0}}},getRowClassName:m,disableRowSelectionOnClick:!0}),t.jsx(_,{sx:{display:"flex",gap:1,mt:2,float:"right",mb:2},children:t.jsx(K,{component:We,buttonLabel:"Add Payment"})})]})},sa=()=>{const{id:e}=U();Ne();const a=w(p=>p.memberData),r=w(p=>p.addOrUpdateMember),[n,c]=u.useState(!1),[l,m]=u.useState({id:"",first_name:"",last_name:"",membership_date:"",membership_fee:""});u.useEffect(()=>{if(e){localStorage.setItem("lastViewedMemberId",e);const p=a.find(x=>x.id===e);p&&m({id:p.id,first_name:p.first_name,last_name:p.last_name,membership_date:p.membership_date,membership_fee:p.membership_fee})}},[e,a]);const i=p=>{const{name:x,value:d}=p.target;m(v=>({...v,[x]:d}))},h=()=>{n&&r(l),c(!n)},o=p=>({"& .MuiOutlinedInput-root.Mui-disabled":{"& fieldset":{borderColor:"#33333310"}}});return t.jsxs(_,{sx:{width:"100%",padding:2,display:"flex",flexDirection:"column",gap:2},children:[t.jsx(C,{label:"Member ID",name:"id",value:l.id,variant:"outlined",fullWidth:!0,InputProps:{readOnly:!0},disabled:!n,sx:o()}),t.jsx(C,{label:"First Name",name:"first_name",value:l.first_name,onChange:i,variant:"outlined",fullWidth:!0,InputProps:{readOnly:!n},disabled:!n,sx:o()}),t.jsx(C,{label:"Last Name",name:"last_name",value:l.last_name,onChange:i,variant:"outlined",fullWidth:!0,InputProps:{readOnly:!n},disabled:!n,sx:o()}),t.jsx(C,{label:"Membership Date",name:"membership_date",value:l.membership_date,onChange:i,variant:"outlined",type:"date",InputLabelProps:{shrink:!0},fullWidth:!0,InputProps:{readOnly:!n},disabled:!n,sx:o()}),t.jsx(C,{label:"Membership Fee",name:"membership_fee",value:l.membership_fee,onChange:i,variant:"outlined",fullWidth:!0,InputProps:{readOnly:!n},disabled:!n,sx:o()}),t.jsx(_,{sx:{display:"flex",justifyContent:"flex-end"},children:t.jsx(j,{variant:"contained",color:"primary",onClick:h,sx:{width:100},children:n?"Save":"Edit"})})]})},ne=e=>typeof e=="number"&&!isNaN(e)?e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):e,la=[{field:"paid",headerName:"Paid",type:"boolean",editable:!0,width:50},{field:"month",headerName:"Month"},{field:"year",headerName:"Year"},{field:"payment",headerName:"Payment",valueFormatter:e=>ne(e)},{field:"interest",headerName:"Interest",valueFormatter:e=>ne(e)},{field:"principal",headerName:"Principal",valueFormatter:e=>ne(e)},{field:"remainingBalance",headerName:"Balance",valueFormatter:e=>ne(e)}],ia=()=>{var i,h;const{id:e}=U(),a=w(o=>o.memberData),r=w(o=>o.updateLoanData),n=a.find(o=>o.id===e),c=n?(h=(i=n.records)==null?void 0:i.loans)==null?void 0:h.flatMap((o,p)=>o.paymentSchedule.map((x,d)=>({id:`${p+1}-${d+1}`,month:new Date(x.year,x.monthValue-1).toLocaleString("default",{month:"long"}),year:x.year,payment:parseFloat(x.payment),interest:parseFloat(x.interestPayment),principal:parseFloat(x.principalPayment),remainingBalance:parseFloat(x.remainingPrincipal),paid:x.remainingPrincipal===0}))):[],l=o=>(r(o),o),m=o=>{const p=new Date,x=p.getFullYear(),d=p.getMonth(),v=new Date(Date.parse(o.row.month+" 1, 2023")).getMonth();return!o.row.paid&&(o.row.year<x||o.row.year===x&&v<d)?"highlight":""};return t.jsxs(_,{sx:{height:"374px",width:"100%"},children:[t.jsx(fe,{rows:c,columns:la,pageSize:5,rowsPerPageOptions:[5,10,20],pagination:!0,processRowUpdate:l,initialState:{pagination:{paginationModel:{pageSize:5,page:0}}},getRowClassName:m,disableRowSelectionOnClick:!0}),t.jsx(_,{sx:{display:"flex",gap:1,mt:2,float:"right",mb:2},children:t.jsx(K,{component:We,buttonLabel:"Add Payment"})})]})},pa=()=>{const[e,a]=u.useState(!0);u.useEffect(()=>{a(!1)},[]);const{id:r}=U(),n=Ne();return u.useEffect(()=>{if(!r){const c=localStorage.getItem("lastViewedMemberId");c&&n(`/members/profile/${c}`)}},[r,n]),t.jsx(Q,{title:"Profile",children:t.jsxs(g,{container:!0,spacing:q,children:[t.jsx(g,{item:!0,xs:6,children:t.jsx(Y,{children:t.jsx(sa,{})})}),t.jsx(g,{item:!0,xs:6,children:t.jsx(Y,{children:t.jsx(ia,{})})}),t.jsx(g,{item:!0,xs:12,children:t.jsx(Y,{children:t.jsx(ta,{})})}),t.jsx(g,{item:!0,xs:8,children:t.jsx(Y,{children:t.jsx(ra,{})})})]})})};export{pa as default};
